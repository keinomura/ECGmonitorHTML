<!DOCTYPE html>
<head>

<title>opewindow</title>
<script>
//12/2 1. value change on main window
//     2. value limit


//open subWindow, keep subWindow Element as sub_win
var sub_win;
//sub_win = window.open('dispWin.html', 'disp window', 'width=300,height=150,scrollbars=1,resizable=1');
openSubWin();

//open subWindow with URL link
function openSubWin(){
        sub_win = window.open('dispWin.html', 'disp window', 'width=300,height=150,scrollbars=1,resizable=1');
         return false;
};

//set initial spO2 value, after HTML loaded
var iniSpO2=95;
window.onload = function() {
        document.getElementById('spO2').innerText = iniSpO2;
};


///////////////////////
// SpO2 buttons
///////////////////////

function numChange(pm) {
  //get spO2 value of ,main_Window
  var main_spO2num=document.getElementById('spO2');
  var spO2val=main_spO2num.innerText;
  //sub_window element
  var sub_spO2num=sub_win.document.getElementById('spO22');
  //spO2 value is number or not
  if (!parseInt(spO2val)==false){ //number
    if (pm == '+') {
      var calcNum = parseInt(spO2val) + 1;
        }else{
      var calcNum = parseInt(spO2val) - 1;
    }
    main_spO2num.innerText = valueLimitation(100, 60, calcNum); //volume limitation
    sub_spO2num.innerText = main_spO2num.innerText;
  }
}

function valueLimitation(upperLimit, lowerLimit, aValue){
 if (aValue >= upperLimit) aValue=upperLimit;
 if (aValue <= lowerLimit) aValue=lowerLimit;
 return aValue;
}//func

///////////////////////
// BP mesure button
///////////////////////

function mesureBP(){
  var main_SBP=document.getElementById('sBP').value;
  var main_DBP=document.getElementById('dBP').value;
  var displayBP=main_SBP + ' / ' + main_DBP;

///////BP display Blink///////
  var count = 0;
  var countup = function(){
    console.log(count++);
  }

  var timerID= setInterval(function(){
    //document.getElementById('bPdisplay').innerText = '--- / ---';
    for (i=1; i<3; i++){
      setTimeout(function(){
      document.getElementById('bPdisplay').textContent = '--- / ---';
      }, 500);
      setTimeout(function(){
      document.getElementById('bPdisplay').innerText = '';
      }, 999);
      console.log('i is ',i);
    }
    countup();
    if(count > 2){
      clearInterval(timerID);
    }
  }, 1000); //call myFunc() each 0.5sec

  

      setTimeout(function(){
              document.getElementById('bPdisplay').textContent = ' ';

        document.getElementById('bPdisplay').innerText = main_SBP +' / '+ main_DBP;
      },4500);
}//func


//clearInterval(timerID);


function blinkBP(count){
    document.getElementById('bPdisplay').innerText = '--- / ---';
for (i=1; i<3; i++){
  setTimeout(function(){
  document.getElementById('bPdisplay').textContent = ' ';
  }, 500);
  setTimeout(function(){
  document.getElementById('bPdisplay').innerText = '--- / ---';
  }, 999);
  console.log('i is ',i);
}
countup(count);
}//

function countup(count){
  count += 1;
  console.log(count);
  if (count > 5) clearInterval(timerID); 
}

</script>

</head>

<body>
<!--
BP elements
  -->
  <div id='bPdisplay'>--- / ---</div>

  <div id='inputField'>
    <input type="text" id='sBP' value=100>
    <input type="text" id='dBP' value=60>
  </div>

  <div class="button">	
    <input type="button" id="mesureBP" value='mesure' onclick="mesureBP();">
	</div>
  




<!--
SpO2 elements
  -->
        <div id='spO2'>5</div>

        <div class="button">	
                <input type="button" id="numUP" value="UP" onclick="numChange('+');">
	</div>
                <div class="button">	
                <input type="button" id="numDW" value="DW" onclick="numChange('-');">
	</div>

        <a href="opeWin.html" onClick="openSubWin()">open child window</a>

</body>
</html>
